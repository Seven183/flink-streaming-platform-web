(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-18f7e05b"],{"166e":function(t,e,r){},"2dea":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"tab-container",attrs:{size:"mini"}},[r("el-form",{ref:"form",attrs:{model:t.form,"label-width":"150px"}},[r("el-form-item",{attrs:{inline:"true"}},[r("span",{attrs:{slot:"label"},slot:"label"},[t._v("企业微信告警 "),r("el-popover",{attrs:{placement:"right",trigger:"hover"}},[r("p",[t._v("企业微信告警所需的url（如果不填写将无法告警）")]),r("p",[t._v("1、目前暂时企业微信群告警且只能添加一个 （当运行的任务挂掉的时候会告警）")]),r("p",[t._v("2、部署的机器需要支持外网否则无法支持企业微信发送")]),r("i",{staticClass:"el-icon-info",attrs:{slot:"reference"},slot:"reference"})])],1),r("el-input",{staticClass:"fl-form-item",attrs:{placeholder:"企业微信告警所需的url"},model:{value:t.form.wechat_alart_url,callback:function(e){t.$set(t.form,"wechat_alart_url",e)},expression:"form.wechat_alart_url"}}),r("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.updateConfig("wechat_alart_url",t.form.wechat_alart_url)}}},[t._v("提交")]),r("el-button",{attrs:{type:"danger"},on:{click:function(e){return t.deleteConfig("wechat_alart_url")}}},[t._v("删除")]),r("el-button",{attrs:{type:"success"},on:{click:function(e){return t.testalarm("/testEnterpriseWeChatAlert")}}},[t._v("测试一下")])],1),r("el-form-item",{attrs:{inline:"true"}},[r("span",{attrs:{slot:"label"},slot:"label"},[t._v("钉钉告警 "),r("el-popover",{attrs:{placement:"right",trigger:"hover"}},[r("p",[t._v("钉钉告警所需的url（如果不填写将无法告警）")]),r("p",[t._v("1、目前暂时钉钉群告警且只能添加一个 （当运行的任务挂掉的时候会告警）")]),r("p",[t._v("2、部署的机器需要支持外网否则无法支持钉钉发送")]),r("i",{staticClass:"el-icon-info",attrs:{slot:"reference"},slot:"reference"})])],1),r("el-input",{staticClass:"fl-form-item",attrs:{placeholder:"钉钉告警所需的url"},model:{value:t.form.dingding_alart_url,callback:function(e){t.$set(t.form,"dingding_alart_url",e)},expression:"form.dingding_alart_url"}}),r("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.updateConfig("dingding_alart_url",t.form.dingding_alart_url)}}},[t._v("提交")]),r("el-button",{attrs:{type:"danger"},on:{click:function(e){return t.deleteConfig("dingding_alart_url")}}},[t._v("删除")]),r("el-button",{attrs:{type:"success"},on:{click:function(e){return t.testalarm("/testDingdingAlert")}}},[t._v("测试一下")])],1),r("el-form-item",{attrs:{inline:"true"}},[r("span",{attrs:{slot:"label"},slot:"label"},[t._v("自定义回调 "),r("el-popover",{attrs:{placement:"right",trigger:"hover",width:"800"}},[r("p",[t._v("自定义http回调告警")]),r("p",[t._v("1、回调url用于支持用户自定义告警，当任务出现告警时，会通过回调url通知 如 http://127.0.0.1/alarmCallback")]),r("p",[t._v("2、回调url支持post、get请求，请求参数是appId、jobName、deployMode 在自定义开发的时候必须要有这三个请求参数，且URN必须是alarmCallback")]),r("i",{staticClass:"el-icon-info",attrs:{slot:"reference"},slot:"reference"})])],1),r("el-input",{staticClass:"fl-form-item",attrs:{placeholder:"自定义http回调告警"},model:{value:t.form.callback_alart_url,callback:function(e){t.$set(t.form,"callback_alart_url",e)},expression:"form.callback_alart_url"}}),r("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.updateConfig("callback_alart_url",t.form.callback_alart_url)}}},[t._v("提交")]),r("el-button",{attrs:{type:"danger"},on:{click:function(e){return t.deleteConfig("callback_alart_url")}}},[t._v("删除")]),r("el-button",{attrs:{type:"success"},on:{click:function(e){return t.testalarm("/testHttpAlert")}}},[t._v("测试一下")])],1)],1)],1)},n=[],l=(r("d3b7"),r("159b"),r("da71")),o={name:"AlarmCfg",data:function(){return{loading:!1,form:{wechat_alart_url:"",dingding_alart_url:"",callback_alart_url:""}}},mounted:function(){this.queryConfig()},methods:{queryConfig:function(){var t=this;this.loading=!0,Object(l["a"])().then((function(e){t.loading=!1;var r=e.code,a=e.success,n=e.message,l=e.data;"200"===r&&a?(t.form.wechat_alart_url="",t.form.dingding_alart_url="",t.form.callback_alart_url="",l.forEach((function(e){"dingding_alart_url"===e.key?t.form.dingding_alart_url=e.val:"callback_alart_url"===e.key?t.form.callback_alart_url=e.val:"wechat_alart_url"===e.key&&(t.form.wechat_alart_url=e.val)}))):t.$message({type:"error",message:n||"请求数据异常！"})})).catch((function(e){t.loading=!1,t.$message({type:"error",message:"请求异常！"}),console.log(e)}))},updateConfig:function(t,e){var r=this;this.loading=!0,Object(l["e"])(t,e).then((function(t){r.loading=!1;var e=t.code,a=t.success,n=t.message;"200"===e&&a?(r.$message({type:"success",message:"更新成功！"}),r.queryConfig()):r.$message({type:"error",message:n||"请求数据异常！"})})).catch((function(t){r.loading=!1,r.$message({type:"error",message:"请求异常！"}),console.log(t)}))},testalarm:function(t){var e=this;console.log(t),Object(l["d"])(t).then((function(t){var r=t.code,a=t.success,n=t.message;"200"===r&&a?(e.$message({type:"success",message:"测试成功！"}),e.queryConfig()):e.$message({type:"error",message:n||"测试数据异常！"})})).catch((function(t){e.$message({type:"error",message:"测试异常！"}),console.log(t)}))},deleteConfig:function(t){var e=this,r="";"dingding_alart_url"===t?r="钉钉告警通知配置":"callback_alart_url"===t?r="自定义告警通知配置":"wechat_alart_url"===t&&(r="企业微信告警通知配置"),this.$confirm("是否删除".concat(r),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.loading=!0,Object(l["b"])(t).then((function(t){e.loading=!1;var r=t.code,a=t.success,n=t.message;"200"===r&&a?(e.$message({type:"success",message:"删除成功！"}),e.queryConfig()):e.$message({type:"error",message:n||"请求数据异常！"})})).catch((function(t){e.loading=!1,e.$message({type:"error",message:"请求异常！"}),console.log(t)}))}))}}},s=o,c=(r("726a"),r("2877")),i=Object(c["a"])(s,a,n,!1,null,"11e6c45d",null);e["default"]=i.exports},"726a":function(t,e,r){"use strict";r("166e")},da71:function(t,e,r){"use strict";r.d(e,"a",(function(){return o})),r.d(e,"c",(function(){return s})),r.d(e,"e",(function(){return c})),r.d(e,"d",(function(){return i})),r.d(e,"b",(function(){return u}));var a=r("b775"),n=r("4328"),l=r.n(n);function o(){return Object(a["a"])({url:"/alartConfig",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(t){return l.a.stringify(t)}],data:{}})}function s(){return Object(a["a"])({url:"/sysConfig",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(t){return l.a.stringify(t)}],data:{}})}function c(t,e){return Object(a["a"])({url:"/upsertSynConfig",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(t){return l.a.stringify(t)}],data:{key:t,val:e}})}function i(t){return Object(a["a"])({url:t,method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function u(t){return Object(a["a"])({url:"/deleteConfig",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(t){return l.a.stringify(t)}],data:{key:t}})}}}]);